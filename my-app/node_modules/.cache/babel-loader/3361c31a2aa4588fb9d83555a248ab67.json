{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\lhh_react\\\\my-app\\\\src\\\\pages\\\\Popular\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport axios from \"axios\";\nimport { NavLink } from \"react-router-dom\";\nimport MyCard from \"../../components/MyCard\";\nimport Load from \"../../components/Load\";\nimport InfiniteScroll from \"react-infinite-scroller\";\nimport { Container, Row, Col } from 'react-bootstrap';\nimport { Spinner } from 'react-bootstrap';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class Popular extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      tabList: [{\n        name: \"All\",\n        url: \"https://api.github.com/search/repositories?q=stars:%3E11&sort=stars&order=desc&type=Repositories&page=\"\n      }, {\n        name: \"java\",\n        url: \"https://api.github.com/search/repositories?q=stars:%3E11+language:java&sort=stars&order=desc&type=Repositories&page=\"\n      }, {\n        name: \"javascript\",\n        url: \"https://api.github.com/search/repositories?q=stars:%3E11+language:javascript&sort=stars&order=desc&type=Repositories&page=\"\n      }, {\n        name: \"css\",\n        url: \"https://api.github.com/search/repositories?q=stars:%3E11+language:css&sort=stars&order=desc&type=Repositories&page=\"\n      }, {\n        name: \"ruby\",\n        url: \"https://api.github.com/search/repositories?q=stars:%3E1+language:ruby&sort=stars&order=desc&type=Repositories&page=\"\n      }, {\n        name: \"python\",\n        url: \"https://api.github.com/search/repositories?q=stars:%3E1+language:python&sort=stars&order=desc&type=Repositories&page=\"\n      }],\n      tabName: \"All\",\n      tabUrl: \"https://api.github.com/search/repositories?q=stars:%3E11&sort=stars&order=desc&type=Repositories&page=\",\n      githubData: [],\n      count: 0,\n      loading: true,\n      pageNum: 1,\n      pageTotal: 5,\n      hasMore: true,\n      errorContent: {},\n      error: false\n    };\n  } //获得数据\n\n\n  async FetchGit() {\n    if (this.state.count === 0) {\n      // const name = localStorage.getItem(\"name\");\n      let obj = {}; // console.log(window.location.href);\n\n      if (window.location.href.includes(\"?\")) {\n        let arr = window.location.href.split(\"?\")[1].split(\"&\");\n\n        for (let i = 0; i < arr.length; i++) {\n          let res = arr[i].split(\"=\");\n          obj[res[0]] = res[1];\n        }\n      }\n\n      console.log(obj.language);\n\n      if (obj.language) {\n        try {\n          const tabUrl = `https://api.github.com/search/repositories?q=stars:%3E1+language:${obj.language}&sort=stars&order=desc&type=Repositories&page=`;\n          const url = tabUrl + this.state.pageNum;\n          const res = await axios.get(url); // console.log(res);\n\n          this.setState({\n            githubData: res.data.items,\n            loading: false,\n            count: this.state.count + 1,\n            name: obj.language,\n            tabUrl: tabUrl,\n            pageNum: 2\n          });\n          const filterOption = document.getElementById(obj.language); // console.log(filterOption);\n\n          if (filterOption) {\n            document.querySelectorAll(\".tab-list.active\").forEach(btn => btn.classList.remove(\"active\"));\n            filterOption.classList.add(\"active\");\n          }\n        } catch (e) {\n          const errorContent = e.response.data.message;\n          this.setState({\n            githubData: [],\n            errorContent,\n            error: true\n          });\n        }\n      } else {\n        const {\n          pageNum,\n          tabUrl,\n          githubData,\n          pageTotal\n        } = this.state;\n\n        if (pageNum > pageTotal) {\n          this.setState({\n            hasMore: false\n          });\n          return;\n        }\n\n        try {\n          const url = tabUrl + pageNum;\n          const res = await axios.get(url);\n          this.setState({\n            githubData: githubData.concat(res.data.items),\n            loading: false,\n            pageNum: pageNum + 1\n          });\n          const filterOption = document.getElementById(\"All\");\n\n          if (filterOption) {\n            document.querySelectorAll(\".tab-list.active\").forEach(btn => btn.classList.remove(\"active\"));\n            filterOption.classList.add(\"active\");\n          }\n        } catch (e) {\n          const errorContent = e.response.data.message;\n          this.setState({\n            githubData: [],\n            errorContent,\n            error: true\n          });\n        }\n      }\n    } else {\n      const {\n        pageNum,\n        tabUrl,\n        githubData,\n        pageTotal\n      } = this.state;\n\n      if (pageNum > pageTotal) {\n        this.setState({\n          hasMore: false\n        });\n        return;\n      }\n\n      try {\n        const url = tabUrl + pageNum;\n        const res = await axios.get(url); // console.log(res);\n\n        this.setState({\n          githubData: githubData.concat(res.data.items),\n          loading: false,\n          pageNum: pageNum + 1,\n          error: false\n        });\n      } catch (e) {\n        const errorContent = e.response.data.message; // console.log(e.response.data.message);\n\n        this.setState({\n          githubData: [],\n          errorContent,\n          error: true\n        });\n      }\n    }\n  }\n\n  componentDidMount() {\n    document.querySelectorAll(\".tab-list.active\").forEach(btn => {\n      btn.classList.remove(\"active\");\n    });\n    this.FetchGit();\n  }\n\n  render() {\n    let renderInfo;\n    const {\n      githubData,\n      hasMore,\n      errorContent,\n      error\n    } = this.state;\n    renderInfo = /*#__PURE__*/_jsxDEV(Load, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }, this);\n\n    if (githubData.length !== 0) {\n      renderInfo = /*#__PURE__*/_jsxDEV(InfiniteScroll, {\n        pageStart: 0,\n        loadMore: () => this.FetchGit(),\n        hasMore: hasMore,\n        loader: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Spinner, {\n              animation: \"border\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 17\n            }, this), \"\\u6B63\\u5728\\u67E5\\u627E\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 15\n          }, this)\n        }, 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 13\n        }, this),\n        children: /*#__PURE__*/_jsxDEV(Container, {\n          children: /*#__PURE__*/_jsxDEV(Row, {\n            children: githubData.map((item, index) => {\n              return /*#__PURE__*/_jsxDEV(Col, {\n                lg: 2,\n                md: 3,\n                sm: 4,\n                children: /*#__PURE__*/_jsxDEV(MyCard, {\n                  listNum: ++index,\n                  avatar: item.owner.avatar_url,\n                  name: item.name,\n                  starsCount: item.stargazers_count,\n                  forksCount: item.forks_count,\n                  openIssuesCount: item.open_issues_count,\n                  htmlUrl: item.html_url\n                }, index, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 197,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 196,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }, this);\n    } else if (error) {\n      renderInfo = /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            textAlign: \"center\",\n            color: \"red\"\n          },\n          children: errorContent\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Container, {\n        style: {\n          marginTop: 30,\n          marginBottom: 30\n        },\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          children: this.state.tabList.map((list, index) => {\n            return /*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(NavLink, {\n                activeClassName: \"MyNavLink\",\n                to: {\n                  pathname: `/Popular`,\n                  search: `?language=${list.name}`\n                },\n                children: list.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this), renderInfo]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Administrator/Desktop/lhh_react/my-app/src/pages/Popular/index.jsx"],"names":["React","Component","axios","NavLink","MyCard","Load","InfiniteScroll","Container","Row","Col","Spinner","Popular","constructor","props","state","tabList","name","url","tabName","tabUrl","githubData","count","loading","pageNum","pageTotal","hasMore","errorContent","error","FetchGit","obj","window","location","href","includes","arr","split","i","length","res","console","log","language","get","setState","data","items","filterOption","document","getElementById","querySelectorAll","forEach","btn","classList","remove","add","e","response","message","concat","componentDidMount","render","renderInfo","textAlign","map","item","index","owner","avatar_url","stargazers_count","forks_count","open_issues_count","html_url","color","marginTop","marginBottom","list","pathname","search"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport axios from \"axios\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport MyCard from \"../../components/MyCard\";\r\nimport Load from \"../../components/Load\";\r\nimport InfiniteScroll from \"react-infinite-scroller\";\r\nimport { Container, Row, Col } from 'react-bootstrap';\r\nimport { Spinner } from 'react-bootstrap';\r\nexport default class Popular extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      tabList: [\r\n        {\r\n          name: \"All\",\r\n          url:\r\n            \"https://api.github.com/search/repositories?q=stars:%3E11&sort=stars&order=desc&type=Repositories&page=\",\r\n        },\r\n        {\r\n          name: \"java\",\r\n          url:\r\n            \"https://api.github.com/search/repositories?q=stars:%3E11+language:java&sort=stars&order=desc&type=Repositories&page=\",\r\n        },\r\n        {\r\n          name: \"javascript\",\r\n          url:\r\n            \"https://api.github.com/search/repositories?q=stars:%3E11+language:javascript&sort=stars&order=desc&type=Repositories&page=\",\r\n        },\r\n        {\r\n          name: \"css\",\r\n          url:\r\n            \"https://api.github.com/search/repositories?q=stars:%3E11+language:css&sort=stars&order=desc&type=Repositories&page=\",\r\n        },\r\n        {\r\n          name: \"ruby\",\r\n          url:\r\n            \"https://api.github.com/search/repositories?q=stars:%3E1+language:ruby&sort=stars&order=desc&type=Repositories&page=\",\r\n        },\r\n        {\r\n          name: \"python\",\r\n          url:\r\n            \"https://api.github.com/search/repositories?q=stars:%3E1+language:python&sort=stars&order=desc&type=Repositories&page=\",\r\n        },\r\n      ],\r\n      tabName: \"All\",\r\n      tabUrl:\r\n        \"https://api.github.com/search/repositories?q=stars:%3E11&sort=stars&order=desc&type=Repositories&page=\",\r\n      githubData: [],\r\n      count: 0,\r\n      loading: true,\r\n      pageNum: 1,\r\n      pageTotal: 5,\r\n      hasMore: true,\r\n      errorContent: {},\r\n      error: false,\r\n    };\r\n  }\r\n  //获得数据\r\n  async FetchGit() {\r\n    if (this.state.count === 0) {\r\n      // const name = localStorage.getItem(\"name\");\r\n      let obj = {};\r\n      // console.log(window.location.href);\r\n      if (window.location.href.includes(\"?\")) {\r\n        let arr = window.location.href.split(\"?\")[1].split(\"&\");\r\n        for (let i = 0; i < arr.length; i++) {\r\n          let res = arr[i].split(\"=\");\r\n          obj[res[0]] = res[1];\r\n        }\r\n      }\r\n      console.log(obj.language);\r\n      if (obj.language) {\r\n        try {\r\n          const tabUrl = `https://api.github.com/search/repositories?q=stars:%3E1+language:${obj.language}&sort=stars&order=desc&type=Repositories&page=`;\r\n          const url = tabUrl + this.state.pageNum;\r\n          const res = await axios.get(url);\r\n          // console.log(res);\r\n          this.setState({\r\n            githubData: res.data.items,\r\n            loading: false,\r\n            count: this.state.count + 1,\r\n            name: obj.language,\r\n            tabUrl: tabUrl,\r\n            pageNum: 2,\r\n          });\r\n          const filterOption = document.getElementById(obj.language);\r\n          // console.log(filterOption);\r\n          if (filterOption) {\r\n            document\r\n              .querySelectorAll(\".tab-list.active\")\r\n              .forEach((btn) => btn.classList.remove(\"active\"));\r\n            filterOption.classList.add(\"active\");\r\n          }\r\n        } catch (e) {\r\n          const errorContent = e.response.data.message;\r\n          this.setState({\r\n            githubData: [],\r\n            errorContent,\r\n            error: true,\r\n          });\r\n        }\r\n      } else {\r\n        const { pageNum, tabUrl, githubData, pageTotal } = this.state;\r\n        if (pageNum > pageTotal) {\r\n          this.setState({\r\n            hasMore: false,\r\n          });\r\n          return;\r\n        }\r\n        try {\r\n          const url = tabUrl + pageNum;\r\n          const res = await axios.get(url);\r\n          this.setState({\r\n            githubData: githubData.concat(res.data.items),\r\n            loading: false,\r\n            pageNum: pageNum + 1,\r\n          });\r\n          const filterOption = document.getElementById(\"All\");\r\n          if (filterOption) {\r\n            document\r\n              .querySelectorAll(\".tab-list.active\")\r\n              .forEach((btn) => btn.classList.remove(\"active\"));\r\n            filterOption.classList.add(\"active\");\r\n          }\r\n        } catch (e) {\r\n          const errorContent = e.response.data.message;\r\n          this.setState({\r\n            githubData: [],\r\n            errorContent,\r\n            error: true,\r\n          });\r\n        }\r\n      }\r\n    } else {\r\n      const { pageNum, tabUrl, githubData, pageTotal } = this.state;\r\n      if (pageNum > pageTotal) {\r\n        this.setState({\r\n          hasMore: false,\r\n        });\r\n        return;\r\n      }\r\n      try {\r\n        const url = tabUrl + pageNum;\r\n        const res = await axios.get(url)\r\n        // console.log(res);\r\n        this.setState({\r\n          githubData: githubData.concat(res.data.items),\r\n          loading: false,\r\n          pageNum: pageNum + 1,\r\n          error: false,\r\n        });\r\n      } catch (e) {\r\n        const errorContent = e.response.data.message;\r\n        // console.log(e.response.data.message);\r\n        this.setState({\r\n          githubData: [],\r\n          errorContent,\r\n          error: true,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    document.querySelectorAll(\".tab-list.active\").forEach((btn) => {\r\n      btn.classList.remove(\"active\");\r\n    });\r\n    this.FetchGit();\r\n  }\r\n\r\n  render() {\r\n    let renderInfo;\r\n    const { githubData, hasMore, errorContent, error } = this.state;\r\n    renderInfo = (\r\n      <Load />\r\n    );\r\n    if (githubData.length !== 0) {\r\n      renderInfo = (\r\n\r\n        <InfiniteScroll\r\n          pageStart={0}\r\n          loadMore={() => this.FetchGit()}\r\n          hasMore={hasMore}\r\n          loader={\r\n            <div key={0}>\r\n              <div style={{ textAlign: 'center' }}>\r\n                <Spinner animation=\"border\" />正在查找\r\n              </div>\r\n            </div>\r\n          }\r\n        >\r\n          <Container>\r\n            <Row>\r\n              {githubData.map((item, index) => {\r\n                return (\r\n                  <Col lg={2} md={3} sm={4}>\r\n                    <MyCard\r\n                      key={index}\r\n                      listNum={++index}\r\n                      avatar={item.owner.avatar_url}\r\n                      name={item.name}\r\n                      starsCount={item.stargazers_count}\r\n                      forksCount={item.forks_count}\r\n                      openIssuesCount={item.open_issues_count}\r\n                      htmlUrl={item.html_url}\r\n                    />\r\n                  </Col>\r\n                );\r\n              })}\r\n            </Row>\r\n          </Container>\r\n        </InfiniteScroll>\r\n\r\n      );\r\n    } else if (error) {\r\n      renderInfo = (\r\n        <div>\r\n          <h3 style={{ textAlign: \"center\", color: \"red\" }}>\r\n            {errorContent}\r\n          </h3>\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div>\r\n        <Container style = {{marginTop:30,marginBottom:30}}>\r\n          <Row>\r\n            {this.state.tabList.map((list, index) => {\r\n              return (\r\n                <Col>\r\n                  <NavLink\r\n                  activeClassName=\"MyNavLink\"\r\n                    to={{\r\n                      pathname: `/Popular`,\r\n                      search: `?language=${list.name}`,\r\n                    }}\r\n                  >\r\n                    {list.name}\r\n                  </NavLink>\r\n                </Col>\r\n              );\r\n            })}\r\n          </Row>\r\n        </Container>\r\n        {renderInfo}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}